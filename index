<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Amiri&family=Nunito:wght@700;900&display=swap" rel="stylesheet">

<style>
  body {
    font-family: 'Nunito', sans-serif;
    background: #f0f2f5;
    padding: 20px;
  }

  .font-arab {
    font-family: 'Amiri', serif;
  }

  .option-box {
    aspect-ratio: 1/1;
    border: 3px solid #e5e7eb;
    border-bottom-width: 8px;
    border-radius: 20px;
    transition: 0.2s;
    cursor: pointer;
    background: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
  }

  .option-box:hover {
    border-color: #3b82f6;
  }

  .option-box:active {
    border-bottom-width: 2px;
    transform: translateY(4px);
  }

  .correct {
    background-color: #dcfce7 !important;
    border-color: #22c55e !important;
    animation: pop 0.3s ease;
  }

  .wrong {
    background-color: #fee2e2 !important;
    border-color: #ef4444 !important;
    animation: shake 0.3s ease;
  }

  @keyframes pop {
    0% {
      transform: scale(1);
    }

    50% {
      transform: scale(1.05);
    }

    100% {
      transform: scale(1);
    }
  }

  @keyframes shake {

    0%,
    100% {
      transform: translateX(0);
    }

    25% {
      transform: translateX(-5px);
    }

    75% {
      transform: translateX(5px);
    }
  }

  #music-control {
    position: fixed;
    top: 15px;
    right: 15px;
    z-index: 100;
    cursor: pointer;
    background: white;
    width: 45px;
    height: 45px;
    border-radius: 50%;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px solid #e5e7eb;
    font-size: 20px;
  }
</style>

<div id="music-control" onclick="toggleMusic(event)">ðŸŽµ</div>

<div id="game-container" class="max-w-xl mx-auto text-center mt-4">
  <div class="flex justify-between items-center mb-4 px-2">
    <span id="score-text" class="font-black text-blue-600">Soal: 1/20</span>
    <h1 class="text-xl font-black uppercase">Kuis Profesi</h1>
  </div>
  <div id="area-soal" class="mb-6 flex justify-center h-48 items-center"></div>
  <div id="grid-pilihan" class="grid grid-cols-2 gap-4"></div>
</div>

<div id="footer" class="fixed bottom-0 left-0 right-0 h-32 bg-white border-t-4 flex items-center justify-around translate-y-full transition-all z-50">
  <div id="info" class="text-xl font-black text-center"></div>
  <button id="next-btn" class="bg-green-500 text-white px-10 py-3 rounded-xl font-black shadow-[0_4px_0_0_#15803d]">LANJUT</button>
</div>

<div id="result-screen" class="hidden fixed inset-0 bg-white z-[100] flex flex-col items-center justify-center p-6 text-center">
  <h2 class="text-3xl font-black mb-2">HASIL AKHIR</h2>
  <div id="final-score" class="text-8xl font-black text-blue-600 mb-6">0</div>
  <p id="result-msg" class="text-xl text-gray-600 mb-8 font-bold"></p>
  <button onclick="restartGame()" class="bg-blue-600 text-white text-xl px-12 py-4 rounded-2xl font-black shadow-[0_6px_0_0_#1d4ed8] hover:bg-blue-500 active:translate-y-1 active:shadow-none transition-all">ULANG KUIS</button>
</div>

<script>
  const bgm = new Audio("https://www.bensound.com/bensound-music/bensound-buddy.mp3");
  bgm.loop = true;
  bgm.volume = 0.05;
  const sfxBenar = new Audio("https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3");
  const sfxSalah = new Audio("https://assets.mixkit.co/active_storage/sfx/2955/2955-preview.mp3");
  let musicEnabled = true;
  let index = 0;
  let soal;
  let dikunci = false;
  let skorBenar = 0;
  let daftarSoalAcak = [];
  const profesi = [{
      ar: "Ø·ÙŽØ¨ÙÙŠÙ’Ø¨ÙŒ",
      idn: "Dokter",
      key: "dokter"
    },
    {
      ar: "Ù…ÙØ¯ÙŽØ±ÙÙ‘Ø³ÙŒ",
      idn: "Guru",
      key: "guru"
    },
    {
      ar: "Ø´ÙØ±Ù’Ø·ÙÙŠÙŒÙ‘",
      idn: "Polisi",
      key: "polisi"
    },
    {
      ar: "Ù…ÙÙ‡ÙŽÙ†Ù’Ø¯ÙØ³ÙŒ",
      idn: "Insinyur",
      key: "insinyur"
    },
    {
      ar: "Ø·ÙŽÙŠÙŽÙ‘Ø§Ø±ÙŒ",
      idn: "Pilot",
      key: "pilot"
    },
    {
      ar: "ÙÙŽÙ„ÙŽÙ‘Ø§Ø­ÙŒ",
      idn: "Petani",
      key: "petani"
    },
    {
      ar: "Ø·ÙŽØ¨ÙŽÙ‘Ø§Ø®ÙŒ",
      idn: "Koki",
      key: "koki"
    },
    {
      ar: "Ù†ÙŽØ¬ÙŽÙ‘Ø§Ø±ÙŒ",
      idn: "Tukang Kayu",
      key: "tukang_kayu"
    },
    {
      ar: "ØªÙŽØ§Ø¬ÙØ±ÙŒ",
      idn: "Pedagang",
      key: "pedagang"
    },
    {
      ar: "Ø¬ÙÙ†Ù’Ø¯ÙÙŠÙŒÙ‘",
      idn: "Tentara",
      key: "tentara"
    },
    {
      ar: "Ù…ÙÙ…ÙŽØ±ÙÙ‘Ø¶ÙŽØ©ÙŒ",
      idn: "Perawat",
      key: "perawat"
    },
    {
      ar: "Ø³ÙŽØ§Ø¦ÙÙ‚ÙŒ",
      idn: "Sopir",
      key: "sopir"
    },
    {
      ar: "Ø­ÙŽÙ„ÙŽÙ‘Ø§Ù‚ÙŒ",
      idn: "Tukang Cukur",
      key: "tukang_cukur"
    },
    {
      ar: "ØµÙŽØ­ÙŽÙÙÙŠÙŒÙ‘",
      idn: "Wartawan",
      key: "wartawan"
    },
    {
      ar: "Ù…ÙØ­ÙŽØ§Ù…Ù",
      idn: "Pengacara",
      key: "pengacara"
    },
    {
      ar: "Ù…ÙÙˆÙŽØ¸ÙŽÙ‘ÙÙŒ",
      idn: "Pegawai",
      key: "pegawai"
    },
    {
      ar: "Ù…ÙØµÙŽÙˆÙÙ‘Ø±ÙŒ",
      idn: "Fotografer",
      key: "fotografer"
    },
    {
      ar: "Ø®ÙŽÙŠÙŽÙ‘Ø§Ø·ÙŒ",
      idn: "Penjahit",
      key: "penjahit"
    },
    {
      ar: "Ø±ÙŽØ§Ø¦ÙØ¯Ù ÙÙŽØ¶ÙŽØ§Ø¡Ù",
      idn: "Astronot",
      key: "astronot"
    },
    {
      ar: "Ø¨ÙØ³Ù’ØªÙŽØ§Ù†ÙÙŠÙŒÙ‘",
      idn: "Tukang Kebun",
      key: "tukang_kebun"
    }
  ];
  const daftarGambar = {
    dokter: "https://glints.com/id/lowongan/wp-content/uploads/2023/08/smiling-asian-male-doctor-pointing-upwards-1.jpg",
    guru: "https://png.pngtree.com/thumb_back/fh260/background/20210902/pngtree-teacher-daytime-male-teacher-indoor-teachers-day-photograph-with-picture-image_784864.jpg",
    polisi: "https://radarcirebon.disway.id/upload/31eff3c72d0d59a6570028c6d755b205.jpg",
    insinyur: "https://png.pngtree.com/png-clipart/20240310/original/pngtree-construction-worker-engineer-png-image_14561951.png",
    pilot: "https://ulasan.co/wp-content/uploads/2024/03/Garuda-Indonesia_Pilot-Capt-Rizka-Triansyah-Leihitu-dengan-pesawat.jpg",
    petani: "https://traveldiva.id/wp-content/uploads/2021/03/AwanTunai.jpeg",
    koki: "https://st3.depositphotos.com/1177973/16888/i/450/depositphotos_168883086-stock-photo-male-chef-on-white-background.jpg",
    tukang_kayu: "https://img.freepik.com/foto-gratis/close-up-seorang-tukang-menggergaji-papan-kayu-panjang_23-2147944920.jpg",
    pedagang: "https://st5.depositphotos.com/10932768/62641/i/450/depositphotos_626418554-stock-photo-smiling-male-salesman-holds-wooden.jpg",
    tentara: "https://upload.wikimedia.org/wikipedia/commons/thumb/b/b1/Panglima_TNI_Jenderal_TNI_Agus_Subiyanto.jpg/250px-Panglima_TNI_Jenderal_TNI_Agus_Subiyanto.jpg",
    perawat: "https://assets.promediateknologi.id/crop/0x0:0x0/750x500/webp/photo/2022/03/16/1566304329.jpg",
    sopir: "https://www.gresiksatu.com/wp-content/uploads/2023/04/c3bb5df3-8b46-4778-8518-4222e8c4fe4e.jpeg",
    tukang_cukur: "https://www.rukita.co/stories/wp-content/uploads/2022/05/images.jpeg-203.jpg",
    wartawan: "https://t4.ftcdn.net/jpg/00/58/01/47/360_F_58014702_QGlsmOkqpmD56kIdCswPk9HuQwxG9JYP.jpg",
    pengacara: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQHbMdBZ4ox6n9DV1JXUaZG8Ds4DxnvAPEUoQ&s",
    pegawai: "https://www.bnok24.com/wp-content/uploads/2024/11/WhatsApp-Image-2024-11-14-at-10.24.51-AM-750x430.jpeg",
    fotografer: "https://dibimbing-cdn.sgp1.cdn.digitaloceanspaces.com/media-strapi/ae3708225d8d1ec54017936bdd5aeeaa.jpg",
    penjahit: "https://media.istockphoto.com/id/834797278/id/foto/tersenyum-penjahit-laki-laki-menjahit-di-bengkel.jpg?s=170667a&w=0&k=20&c=008vgxnfpRBMU-2rTQ0a4pd0jI9v70DANFTXlItvKYo=",
    astronot: "https://upload.wikimedia.org/wikipedia/commons/0/0d/Neil_Armstrong_pose.jpg",
    tukang_kebun: "https://images.pexels.com/photos/1105019/pexels-photo-1105019.jpeg"
  };

  function toggleMusic(e) {
    if (e) e.stopPropagation();
    musicEnabled = !musicEnabled;
    if (musicEnabled) {
      bgm.play();
      document.getElementById('music-control').innerText = "ðŸŽµ";
    } else {
      bgm.pause();
      document.getElementById('music-control').innerText = "ðŸ”‡";
    }
  }

  function duckMusic(duration = 2000) {
    if (!musicEnabled) return;
    bgm.volume = 0.01;
    setTimeout(() => {
      if (musicEnabled) bgm.volume = 0.05;
    }, duration);
  }

  function speak(t) {
    duckMusic(2500);
    const u = new SpeechSynthesisUtterance(t);
    u.lang = 'ar-SA';
    u.rate = 0.7;
    window.speechSynthesis.speak(u);
  }

  function shuffleSoal() {
    daftarSoalAcak = [...profesi].sort(() => 0.5 - Math.random());
  }

  function load() {
    if (index >= 20) return tampilkanNilai();
    dikunci = false;
    soal = daftarSoalAcak[index];
    const mode = index % 2; // Gonta-ganti mode gambar/suara
    document.getElementById('score-text').innerText = `Soal: ${index + 1}/20`;
    document.getElementById('footer').classList.add('translate-y-full');
    document.getElementById('grid-pilihan').innerHTML = '';
    if (mode === 0) {
      document.getElementById('area-soal').innerHTML = `<img src="${daftarGambar[soal.key]}" class="w-48 h-48 object-cover rounded-3xl shadow-lg border-4 border-white">`;
      render('text');
    } else {
      document.getElementById('area-soal').innerHTML = `<button onclick="speak('${soal.ar}')" class="bg-blue-500 w-32 h-32 rounded-full text-white shadow-lg text-5xl flex items-center justify-center hover:scale-105 transition-all">ðŸ”Š</button>`;
      render('img');
      setTimeout(() => {
        if (!dikunci) speak(soal.ar);
      }, 800);
    }
  }

  function render(type) {
    let opsi = [...profesi].sort(() => 0.5 - Math.random()).slice(0, 4);
    if (!opsi.find(o => o.ar === soal.ar)) opsi[0] = soal;
    opsi.sort(() => 0.5 - Math.random());
    opsi.forEach(o => {
      const box = document.createElement('div');
      box.className = "option-box";
      let content = (type === 'text') ? `<span class="text-3xl font-arab font-bold" dir="rtl">${o.ar}</span>` : `<img src="${daftarGambar[o.key]}" class="w-full h-full object-cover">`;
      box.innerHTML = `<button onclick="event.stopPropagation(); speak('${o.ar}')" class="absolute top-2 right-2 bg-blue-100 p-2 rounded-full text-xs z-10">ðŸ”Š</button>${content}`;
      box.onclick = () => {
        if (dikunci) return;
        dikunci = true;
        const f = document.getElementById('footer');
        f.classList.remove('translate-y-full');
        duckMusic(3500);
        if (o.ar === soal.ar) {
          skorBenar++;
          box.classList.add('correct');
          sfxBenar.play();
          document.getElementById('info').innerHTML = "<span class='text-green-600'>Mumtaz! (Benar)</span>";
          f.style.background = "#f0fff4";
          sfxBenar.onended = () => {
            speak(soal.ar);
          };
        } else {
          box.classList.add('wrong');
          sfxSalah.play();
          document.getElementById('info').innerHTML = "<span class='text-red-600'>Kurang Tepat</span>";
          f.style.background = "#fff5f5";
          sfxSalah.onended = () => {
            speak(soal.ar);
          };
        }
      };
      document.getElementById('grid-pilihan').appendChild(box);
    });
  }

  function tampilkanNilai() {
    const totalNilai = (skorBenar / 20) * 100;
    document.getElementById('final-score').innerText = totalNilai;
    document.getElementById('result-screen').classList.remove('hidden');
    let pesan = "";
    if (totalNilai === 100) pesan = "Luar Biasa! Sempurna!";
    else if (totalNilai >= 70) pesan = "Bagus Sekali! Teruskan Belajar!";
    else pesan = "Jangan Menyerah, Ayo Coba Lagi!";
    document.getElementById('result-msg').innerText = pesan;
  }

  function restartGame() {
    index = 0;
    skorBenar = 0;
    document.getElementById('result-screen').classList.add('hidden');
    shuffleSoal();
    load();
  }
  document.getElementById('next-btn').onclick = () => {
    window.speechSynthesis.cancel();
    index++;
    load();
  };
  window.onclick = () => {
    if (musicEnabled && bgm.paused) bgm.play();
  }
  window.onload = () => {
    shuffleSoal();
    load();
  }
</script>
