<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kuis Profesi Arab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Amiri&family=Nunito:wght@700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Nunito', sans-serif; background: #f0f2f5; touch-action: manipulation; }
        .font-arab { font-family: 'Amiri', serif; }
        .option-box { 
            aspect-ratio: 1/1; border: 3px solid #e5e7eb; border-bottom-width: 8px; 
            border-radius: 20px; transition: 0.2s; cursor: pointer; background: white;
            display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative;
            overflow: hidden;
        }
        .correct { background-color: #dcfce7 !important; border-color: #22c55e !important; }
        .wrong { background-color: #fee2e2 !important; border-color: #ef4444 !important; }
    </style>
</head>
<body>

<div id="start-screen" class="fixed inset-0 bg-blue-600 z-[200] flex flex-col items-center justify-center p-6 text-center">
    <div class="bg-white p-8 rounded-3xl shadow-2xl w-full max-w-md">
        <h1 class="text-3xl font-black text-blue-600 mb-6">KUIS PROFESI</h1>
        <input type="text" id="user-name" placeholder="Nama kamu..." class="w-full p-4 border-4 border-gray-100 rounded-2xl mb-6 text-center text-xl font-bold">
        <button onclick="startGame()" class="w-full bg-green-500 text-white text-xl py-4 rounded-2xl font-black shadow-[0_6px_0_0_#15803d]">MULAI KUIS</button>
        <p class="mt-4 text-xs text-gray-400 font-bold">*Klik MULAI akan mengaktifkan suara di HP</p>
    </div>
</div>

<div id="game-container" class="max-w-xl mx-auto p-4 hidden">
    <div class="flex justify-between items-center mb-4">
        <span id="score-text" class="font-black text-blue-600">Soal: 1/20</span>
        <span id="display-player-name" class="text-gray-400 font-black uppercase">Pemain</span>
    </div>
    <div id="area-soal" class="mb-6 flex justify-center h-48 items-center"></div>
    <div id="grid-pilihan" class="grid grid-cols-2 gap-4"></div>
</div>

<div id="footer" class="fixed bottom-0 left-0 right-0 h-32 bg-white border-t-4 flex items-center justify-around translate-y-full transition-all z-50">
    <div id="info" class="text-xl font-black"></div>
    <button id="next-btn" class="bg-green-500 text-white px-10 py-3 rounded-xl font-black shadow-[0_4px_0_0_#15803d]">LANJUT</button>
</div>

<script>
    let synth = window.speechSynthesis;
    let index = 0;
    let skorBenar = 0;
    let playerName = "";

    const profesi = [
        { ar: "Ø·ÙŽØ¨ÙÙŠÙ’Ø¨ÙŒ", idn: "Dokter", key: "dokter" },
        { ar: "Ù…ÙØ¯ÙŽØ±ÙÙ‘Ø³ÙŒ", idn: "Guru", key: "guru" },
        { ar: "Ø´ÙØ±Ù’Ø·ÙÙŠÙŒÙ‘", idn: "Polisi", key: "polisi" },
        { ar: "Ù…ÙÙ‡ÙŽÙ†Ù’Ø¯ÙØ³ÙŒ", idn: "Insinyur", key: "insinyur" }
        // ... (tambah profesi lainnya di sini)
    ];

    function speak(t) {
        if (!t) return;
        synth.cancel(); // Hentikan suara sebelumnya agar tidak menumpuk
        const u = new SpeechSynthesisUtterance(t);
        u.lang = 'ar-SA';
        u.rate = 0.8;
        
        // Cek jika suara tersedia di sistem
        const voices = synth.getVoices();
        const arabicVoice = voices.find(v => v.lang.includes('ar'));
        if (arabicVoice) u.voice = arabicVoice;
        
        synth.speak(u);
    }

    function startGame() {
        const input = document.getElementById('user-name').value;
        if(!input) return alert("Isi nama dulu ya!");
        
        playerName = input;
        
        // PENTING: Pemicu suara pertama kali agar browser HP mengizinkan audio
        speak(" "); 
        
        document.getElementById('start-screen').classList.add('hidden');
        document.getElementById('game-container').classList.remove('hidden');
        loadSoal();
    }

    function loadSoal() {
        if (index >= profesi.length) return alert("Selesai!");
        
        const soal = profesi[index];
        document.getElementById('score-text').innerText = `Soal: ${index + 1}/${profesi.length}`;
        document.getElementById('display-player-name').innerText = playerName;
        document.getElementById('area-soal').innerHTML = `<button onclick="speak('${soal.ar}')" class="bg-blue-500 w-32 h-32 rounded-full text-white text-5xl flex items-center justify-center shadow-lg">ðŸ”Š</button>`;
        
        renderPilihan(soal);
    }

    function renderPilihan(soal) {
        const grid = document.getElementById('grid-pilihan');
        grid.innerHTML = '';
        
        let opsi = [...profesi].sort(() => 0.5 - Math.random()).slice(0, 4);
        if (!opsi.find(o => o.ar === soal.ar)) opsi[0] = soal;
        opsi.sort(() => 0.5 - Math.random());

        opsi.forEach(o => {
            const btn = document.createElement('div');
            btn.className = "option-box text-2xl font-black";
            btn.innerText = o.idn;
            btn.onclick = () => {
                if (o.idn === soal.idn) {
                    btn.classList.add('correct');
                    speak(soal.ar); // Bunyi saat jawaban benar
                } else {
                    btn.classList.add('wrong');
                }
            };
            grid.appendChild(btn);
        });
    }

    // Memuat ulang daftar suara (beberapa HP butuh ini)
    if (speechSynthesis.onvoiceschanged !== undefined) {
        speechSynthesis.onvoiceschanged = () => synth.getVoices();
    }
</script>
</body>
</html>
